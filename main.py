class ActionKind(Enum):
    Walking = 0
    Idle = 1
    Jumping = 2
    Dead = 3
@namespace
class SpriteKind:
    Ground = SpriteKind.create()
    Cloud = SpriteKind.create()
def initGround():
    global ground1, ground2
    ground1 = sprites.create(img("""
            ...................................................................................cccc...........................................................................
            ..................................................................................c....c..........................................................................
            cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc......ccccccccccccccccc....ccccccccccccccccccccccccccccccccccccccccccccccccccccc
            .........................................................................................................cccc.....................................................
            ..................................................................................................................................................................
            ..cccc..c.......................c..cccc.........................cccc..c.............c..........................cccc..c...........c..ccc.................c..ccc....
            ..................................................................................................................................................................
            ...............cccc..c.........................cccc.c.......c..............cc.c........cccc..c.....cccc..c..................c...............cccc..c...............
            ..................................................................................................................................................................
            ..................................................................................................................................................................
            ..................................................................................................................................................................
            ..................................................................................................................................................................
            ..................................................................................................................................................................
            ..................................................................................................................................................................
            ..................................................................................................................................................................
            ..................................................................................................................................................................
            ..................................................................................................................................................................
            ..................................................................................................................................................................
            ..................................................................................................................................................................
            ..................................................................................................................................................................
            ..................................................................................................................................................................
            ..................................................................................................................................................................
            ..................................................................................................................................................................
            ..................................................................................................................................................................
            ..................................................................................................................................................................
            ..................................................................................................................................................................
            ..................................................................................................................................................................
            ..................................................................................................................................................................
            ..................................................................................................................................................................
            ..................................................................................................................................................................
            ..................................................................................................................................................................
            ..................................................................................................................................................................
            """),
        SpriteKind.Ground)
    ground2 = sprites.create(img("""
            .....................................................cccc..................cccc...................................................................................
            ....................................................c....c................c....c..................................................................................
            cccccccccccccccccccccccccccccccccccccccccccccccccccc......cccccccccccccccc......cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
            ..................................................................................................................................................................
            ..................................................................................................................................................................
            ....ccc..c.................ccc..c...........c..cccc..........................c.............c..cccc.........................cccc..c.......................c..cccc..
            ..................................................................................................................................................................
            ...............c..cccc...............c..................c..cccc.....c..cccc........c.cc..............c.......c.cccc.........................c..cccc...............
            ..................................................................................................................................................................
            ..................................................................................................................................................................
            ..................................................................................................................................................................
            ..................................................................................................................................................................
            ..................................................................................................................................................................
            ..................................................................................................................................................................
            ..................................................................................................................................................................
            ..................................................................................................................................................................
            ..................................................................................................................................................................
            ..................................................................................................................................................................
            ..................................................................................................................................................................
            ..................................................................................................................................................................
            ..................................................................................................................................................................
            ..................................................................................................................................................................
            ..................................................................................................................................................................
            ..................................................................................................................................................................
            ..................................................................................................................................................................
            ..................................................................................................................................................................
            ..................................................................................................................................................................
            ..................................................................................................................................................................
            ..................................................................................................................................................................
            ..................................................................................................................................................................
            ..................................................................................................................................................................
            ..................................................................................................................................................................
            """),
        SpriteKind.Ground)
    ground1.set_position(scene.screen_width() / 2, 120)
    ground2.set_position(ground1.x + scene.screen_width(), 120)
    ground1.vx = -100
    ground2.vx = -100
    ground1.z = 50
    ground2.z = 2
def initRaptor():
    global raptor, run
    raptor = sprites.create(img("""
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ........................fff.....
            .......................fcccff...
            ......................fc1fcccf..
            ......................fccccccf..
            .................fffffcccccff...
            .............ffffcccccccccf.....
            .........ffffccccccccccccf......
            .....ffffcccccccccccccccf.......
            ...fccccccccccccccccccccf.......
            ..fccc......fffccccccfffcf......
            ...............ffcccf...cf......
            .................fccf..ff.......
            .................fcf............
            ................fccf............
            ................fcf.............
            ................fcf.............
            .................f..............
            """),
        SpriteKind.player)
    run = animation.create_animation(ActionKind.Walking, 100)
    raptor.z = 3
    raptor.set_position(15, 94)

def on_a_pressed():
    if raptor.y == 94 and end == 0:
        raptor.vy = -200
        animation.set_action(raptor, ActionKind.Walking)
controller.A.on_event(ControllerButtonEvent.PRESSED, on_a_pressed)

def on_on_overlap(sprite, otherSprite):
    global end
    end = 1
    pause(50)
    game.over(False, effects.dissolve)
sprites.on_overlap(SpriteKind.player, SpriteKind.projectile, on_on_overlap)

cloud: Sprite = None
cactus: Sprite = None
run: animation.Animation = None
raptor: Sprite = None
ground2: Sprite = None
ground1: Sprite = None
end = 0
idle = None
game.set_dialog_cursor(img("""
    ................................
    ..1111111111111111111111111111..
    .111111111111111111111111111111.
    11111111111111111111111111111111
    11111111111111111111111111111111
    11111111111111111111111111111111
    11111111111111111111111111111111
    11111111111111111111111111111111
    11111111111111111111111111111111
    111111111111111111111111fff11111
    11111111111111111111111fcccff111
    1111111111111111111111fc1fcccf11
    1111111111111111111111fccccccf11
    11111111111111111fffffcccccff111
    1111111111111ffffcccccccccf11111
    111111111ffffccccccccccccf111111
    11111ffffcccccccccccccccf1111111
    111fccccccccccccccccccccf1111111
    11fccc111111fffccccccfffcf111111
    111111111111111ffcccf111cf111111
    11111111111111111fccf11ff1111111
    11111111111111111fcf111111111111
    1111111111111111fccf111111111111
    1111111111111111fcf1111111111111
    1111111111111111fcf1111111111111
    11111111111111111f11111111111111
    11111111111111111111111111111111
    11111111111111111111111111111111
    11111111111111111111111111111111
    11111111111111111111111111111111
    .111111111111111111111111111111.
    ..1111111111111111111111111111..
    """))
game.splash("Raptor Run")
scene.set_background_color(1)
initGround()
initRaptor()
info.set_score(0)
end = 0
game.show_long_text("Press any button to jump.", DialogLayout.TOP)

def on_on_update():
    if raptor.y < 94:
        raptor.ay = 600
    else:
        raptor.ay = 0
        raptor.y = 94
        if end == 0:
            animation.set_action(raptor, ActionKind.Walking)
    if ground2.x < -1 * (scene.screen_width() / 2):
        ground2.x = ground1.x + scene.screen_width()
    if ground1.x < -1 * (scene.screen_width() / 2):
        ground1.x = ground2.x + scene.screen_width()
game.on_update(on_on_update)

def on_update_interval():
    global cactus
    info.change_score_by(1)
    if Math.percent_chance(5):
        cactus = sprites.create_projectile_from_side(img("""
                ................................
                ................................
                ................................
                ................................
                ................................
                ................................
                ................................
                ................................
                ................................
                ................................
                ................................
                ................................
                ..............ccc...............
                .............ccccc..............
                .............ccccc..............
                .............ccccc...c..........
                .........c...ccccc..ccc.........
                ........ccc..ccccc..ccc.........
                ........ccc..ccccc..ccc.........
                ........ccc..ccccc..ccc.........
                ........cccccccccc..ccc.........
                ........cccccccccc..ccc.........
                .........cccccccccccccc.........
                .............cccccccccc.........
                .............ccccccccc..........
                .............ccccc..............
                .............ccccc..............
                .............ccccc..............
                .............ccccc..............
                .............ccccc..............
                .............ccccc..............
                .............ccccc..............
                """),
            ground1.vx,
            0)
        cactus.y = 94
        cactus.z = 2
game.on_update_interval(50, on_update_interval)

def on_update_interval2():
    ground1.vx += -1
    ground2.vx += -1
game.on_update_interval(1000, on_update_interval2)

def on_update_interval3():
    global cloud
    if Math.percent_chance(25):
        cloud = sprites.create_projectile_from_side(img("""
                ................................
                ................................
                ................................
                ................................
                ................................
                ................................
                ................................
                ................................
                ................................
                ................................
                ................................
                ................................
                ................................
                ................................
                ................bbbb.bb.........
                ...............bb.....b.........
                .............bbb......bbb.......
                .............b..........bbbb....
                .............b.............b....
                ..........bbbb.............bbb..
                .........bb..................b..
                .....bbbbb...................bb.
                .....b........................b.
                .bb.bb..b......................b
                bb.......bbbbbbbbbbbbbbbbbbbbbbb
                ................................
                ................................
                ................................
                ................................
                ................................
                ................................
                ................................
                """),
            ground1.vx / 4,
            0)
        cloud.y = randint(20, 60)
        cloud.set_kind(SpriteKind.Cloud)
        cloud.z = 1
game.on_update_interval(1500, on_update_interval3)
